<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Opening Visualizer - Learn Chess Openings Interactively</title>
    <meta name="description" content="Interactive chess opening visualizer. Learn chess openings with step-by-step visual demonstrations.">
    <meta name="keywords" content="chess, opening, visualizer, gambits, chess tutorial, chess learning">
    <meta name="author" content="Mahmoud Elshenhab">
    
    <!-- Open Graph meta tags -->
    <meta property="og:title" content="Chess Opening Visualizer">
    <meta property="og:description" content="Learn chess openings interactively with visual demonstrations">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://shenhab.github.io/ChessGambits/">
    
    <!-- Twitter meta tags -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Chess Opening Visualizer">
    <meta name="twitter:description" content="Learn chess openings interactively with visual demonstrations">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>♟️</text></svg>">
    
    <style>
        /* Modern CSS Reset */
        *, *::before, *::after {
            box-sizing: border-box;
        }
        
        * {
            margin: 0;
        }
        
        body {
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        /* Main container */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin: 0;
        }
        
        /* Main content */
        .content {
            padding: 30px;
        }
        
        /* Loading indicator */
        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(102, 126, 234, 0.3);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Opening selector */
        .opening-selector {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .opening-selector label {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
            margin-right: 15px;
            display: block;
            margin-bottom: 10px;
        }
        
        .selector-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        
        select {
            padding: 12px 20px;
            font-size: 1.1rem;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            background: white;
            min-width: 250px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #2c3e50;
            font-weight: 500;
        }
        
        select:hover {
            border-color: #667eea;
        }
        
        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        /* Color indicator */
        .color-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 20px;
            font-weight: 600;
            font-size: 1rem;
        }
        
        .color-indicator.white {
            background: linear-gradient(135deg, #e0e0e0 0%, #f5f5f5 100%);
            color: #333;
        }
        
        .color-indicator.black {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
        }
        
        /* Chess board */
        .board-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            position: relative;
        }
        
        .chess-board {
            display: grid;
            grid-template-columns: repeat(8, 65px);
            grid-template-rows: repeat(8, 65px);
            border: 4px solid #2c3e50;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease;
        }
        
        .chess-board.flipped {
            transform: rotate(180deg);
        }
        
        .chess-board:hover {
            transform: scale(1.02);
        }
        
        .chess-board.flipped:hover {
            transform: rotate(180deg) scale(1.02);
        }
        
        .square {
            width: 65px;
            height: 65px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .chess-board.flipped .square {
            transform: rotate(180deg);
        }
        
        .square:hover {
            transform: scale(1.1);
            z-index: 10;
            border-radius: 8px;
        }
        
        .chess-board.flipped .square:hover {
            transform: rotate(180deg) scale(1.1);
        }
        
        .light {
            background-color: #f0d9b5;
        }
        
        .dark {
            background-color: #b58863;
        }
        
        .square:hover.light {
            background-color: #f5e6c8;
        }
        
        .square:hover.dark {
            background-color: #c19a74;
        }
        
        /* Coordinates */
        .coordinates {
            position: absolute;
            font-size: 11px;
            font-weight: bold;
            color: rgba(0, 0, 0, 0.4);
            pointer-events: none;
        }
        
        .coord-file {
            bottom: 2px;
            right: 3px;
        }
        
        .coord-rank {
            top: 2px;
            left: 3px;
        }
        
        /* Chess pieces */
        .piece {
            font-size: 40px;
            line-height: 1;
            transition: all 0.3s ease;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            user-select: none;
        }
        
        .piece:hover {
            transform: scale(1.2);
            filter: brightness(1.1);
        }
        
        /* Controls */
        .controls {
            text-align: center;
            margin: 30px 0;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 14px 28px;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .btn-flip {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }
        
        .btn:disabled {
            background: #95a5a6;
            color: white;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.6;
        }
        
        .btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }
        
        /* Move info */
        .move-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .move-info h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .move-info p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin: 0;
            opacity: 0.95;
        }
        
        .move-counter {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            margin-top: 15px;
            font-size: 0.95rem;
        }
        
        /* Error message */
        .error-message {
            background: #ff6b6b;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }
        
        /* Footer */
        .footer {
            background: #f8f9fa;
            padding: 25px;
            text-align: center;
            border-top: 1px solid #e1e8ed;
            color: #6c757d;
        }
        
        .footer a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        /* GitHub corner */
        .github-corner {
            position: fixed;
            top: 0;
            right: 0;
            z-index: 1000;
        }
        
        .github-corner svg {
            fill: #2c3e50;
            color: white;
            position: absolute;
            top: 0;
            border: 0;
            right: 0;
        }
        
        .github-corner:hover .octo-arm {
            animation: octocat-wave 560ms ease-in-out;
        }
        
        @keyframes octocat-wave {
            0%, 20%, 60%, 100% {
                transform: rotate(0);
            }
            40%, 80% {
                transform: rotate(-25deg);
            }
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .chess-board {
                grid-template-columns: repeat(8, 45px);
                grid-template-rows: repeat(8, 45px);
            }
            
            .square {
                width: 45px;
                height: 45px;
                font-size: 30px;
            }
            
            .piece {
                font-size: 30px;
            }
            
            .content {
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 250px;
            }
            
            select {
                min-width: 200px;
            }
            
            .move-info h3 {
                font-size: 1.5rem;
            }
            
            .move-info p {
                font-size: 1rem;
            }
            
            .selector-group {
                flex-direction: column;
            }
        }
        
        @media (max-width: 480px) {
            .chess-board {
                grid-template-columns: repeat(8, 35px);
                grid-template-rows: repeat(8, 35px);
            }
            
            .square {
                width: 35px;
                height: 35px;
                font-size: 24px;
            }
            
            .piece {
                font-size: 24px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .header p {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- GitHub Corner -->
    <a href="https://github.com/shenhab/ChessGambits" class="github-corner" aria-label="View source on GitHub">
        <svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
            <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
            <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
    </a>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>♟️ Chess Opening Visualizer ♔</h1>
            <p>Learn chess openings through interactive visual demonstrations</p>
        </header>

        <!-- Main content -->
        <main class="content">
            <!-- Loading indicator -->
            <div id="loadingIndicator" class="loading" style="display: none;">
                <div class="loading-spinner"></div>
                <p>Loading gambits...</p>
            </div>

            <!-- Error message -->
            <div id="errorMessage" class="error-message" style="display: none;"></div>

            <!-- Opening selector -->
            <div class="opening-selector">
                <label for="opening">Choose Your Opening to Study:</label>
                <div class="selector-group">
                    <select id="opening" onchange="loadOpening()" aria-label="Select chess opening">
                        <option value="">-- Select an Opening --</option>
                    </select>
                    <span id="colorIndicator" class="color-indicator" style="display: none;">
                        <span id="colorText">White</span>
                    </span>
                </div>
            </div>

            <!-- Chess board -->
            <div class="board-container">
                <div class="chess-board" id="board" role="grid" aria-label="Chess board"></div>
            </div>

            <!-- Controls -->
            <div class="controls">
                <button onclick="previousMove()" id="prevBtn" class="btn btn-secondary" aria-label="Previous move">
                    ← Previous
                </button>
                <button onclick="nextMove()" id="nextBtn" class="btn btn-primary" aria-label="Next move">
                    Next →
                </button>
                <button onclick="resetBoard()" class="btn btn-success" aria-label="Reset to starting position">
                    🔄 Reset
                </button>
                <button onclick="flipBoard()" class="btn btn-flip" aria-label="Flip board">
                    🔄 Flip Board
                </button>
            </div>

            <!-- Move information -->
            <div class="move-info" id="moveInfo" role="status" aria-live="polite">
                <h3>Welcome to Chess Opening Visualizer!</h3>
                <p>Select an opening from the dropdown above to begin learning. Each opening is loaded as a separate module for easy management.</p>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>Made with ❤️ for chess enthusiasts | <a href="https://github.com/shenhab/ChessGambits">View on GitHub</a> | Add your own gambits in the /gambits directory!</p>
        </footer>
    </div>

    <script>
        // Chess piece symbols (Unicode)
        const pieces = {
            'K': '♔', 'Q': '♕', 'R': '♖', 'B': '♗', 'N': '♘', 'P': '♙',
            'k': '♚', 'q': '♛', 'r': '♜', 'b': '♝', 'n': '♞', 'p': '♟'
        };
        
        // Starting chess position
        const startingPosition = [
            ['r', 'n', 'b', 'q', 'k', 'b', 'n', 'r'],
            ['p', 'p', 'p', 'p', 'p', 'p', 'p', 'p'],
            ['.', '.', '.', '.', '.', '.', '.', '.'],
            ['.', '.', '.', '.', '.', '.', '.', '.'],
            ['.', '.', '.', '.', '.', '.', '.', '.'],
            ['.', '.', '.', '.', '.', '.', '.', '.'],
            ['P', 'P', 'P', 'P', 'P', 'P', 'P', 'P'],
            ['R', 'N', 'B', 'Q', 'K', 'B', 'N', 'R']
        ];
        
        // Global variables
        let currentOpening = null;
        let currentMoveIndex = 0;
        let availableGambits = {};
        let boardFlipped = false;
        
        // List of gambit files to load
        const gambitFiles = [
            'italian-opening.js',
            'kings-gambit.js',
            'latvian-gambit.js',
            'evans-gambit.js',
            'scandinavian-defense.js',
            'queens-gambit.js',
            'kings-indian-defense.js',
            'sicilian-defense.js',
            'french-defense.js',
            'ruy-lopez.js'
        ];
        
        // Initialize the board
        function initBoard() {
            const board = document.getElementById('board');
            board.innerHTML = '';
            
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement('div');
                    square.className = 'square ' + ((row + col) % 2 === 0 ? 'light' : 'dark');
                    
                    // Add coordinates to edge squares
                    if (col === 0) {
                        const rankCoord = document.createElement('span');
                        rankCoord.className = 'coordinates coord-rank';
                        rankCoord.textContent = boardFlipped ? (row + 1) : (8 - row);
                        square.appendChild(rankCoord);
                    }
                    if (row === 7) {
                        const fileCoord = document.createElement('span');
                        fileCoord.className = 'coordinates coord-file';
                        fileCoord.textContent = String.fromCharCode(boardFlipped ? (104 - col) : (97 + col));
                        square.appendChild(fileCoord);
                    }
                    
                    board.appendChild(square);
                }
            }
        }
        
        // Render the current position
        function renderPosition(position) {
            const squares = document.querySelectorAll('.square');
            let squareIndex = 0;
            
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const piece = position[row][col];
                    const square = squares[squareIndex];
                    
                    // Clear existing piece
                    const existingPiece = square.querySelector('.piece');
                    if (existingPiece) {
                        existingPiece.remove();
                    }
                    
                    // Add new piece if not empty
                    if (piece !== '.') {
                        const pieceElement = document.createElement('span');
                        pieceElement.className = 'piece';
                        pieceElement.textContent = pieces[piece] || '';
                        square.appendChild(pieceElement);
                    }
                    
                    squareIndex++;
                }
            }
        }
        
        // Load gambits from directory
        async function loadGambits() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            const errorMessage = document.getElementById('errorMessage');
            const openingSelect = document.getElementById('opening');
            
            loadingIndicator.style.display = 'block';
            errorMessage.style.display = 'none';
            
            // Clear existing options
            openingSelect.innerHTML = '<option value="">-- Select an Opening --</option>';
            
            // Reset the global gambits registry
            window.ChessGambits = {};
            
            let loadedCount = 0;
            let errorCount = 0;
            
            for (const file of gambitFiles) {
                try {
                    // Create a script element to load the gambit file
                    const script = document.createElement('script');
                    script.src = `gambits/${file}`;
                    
                    // Wait for script to load
                    await new Promise((resolve, reject) => {
                        script.onload = () => {
                            loadedCount++;
                            resolve();
                        };
                        script.onerror = () => {
                            errorCount++;
                            console.warn(`Failed to load gambit file: ${file}`);
                            resolve(); // Continue loading other files
                        };
                        document.head.appendChild(script);
                    });
                } catch (error) {
                    console.error(`Error loading ${file}:`, error);
                    errorCount++;
                }
            }
            
            // Update available gambits from registry
            availableGambits = window.ChessGambits || {};
            
            // Populate the select dropdown
            for (const [key, gambit] of Object.entries(availableGambits)) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = `${gambit.icon || '♟️'} ${gambit.name}`;
                openingSelect.appendChild(option);
            }
            
            loadingIndicator.style.display = 'none';
            
            if (loadedCount === 0) {
                errorMessage.textContent = 'No gambit files could be loaded. Please check the /gambits directory.';
                errorMessage.style.display = 'block';
            } else if (errorCount > 0) {
                console.log(`Loaded ${loadedCount} gambits, ${errorCount} files not found or had errors.`);
            }
        }
        
        // Load an opening
        function loadOpening() {
            const openingSelect = document.getElementById('opening');
            const selectedOpening = openingSelect.value;
            const colorIndicator = document.getElementById('colorIndicator');
            const colorText = document.getElementById('colorText');
            
            if (!selectedOpening) {
                currentOpening = null;
                colorIndicator.style.display = 'none';
                renderPosition(startingPosition);
                updateMoveInfo("Welcome!", "Select an opening from the dropdown above to begin learning.");
                updateButtons();
                return;
            }
            
            currentOpening = availableGambits[selectedOpening];
            currentMoveIndex = 0;
            
            // Show color indicator
            if (currentOpening.color) {
                colorIndicator.style.display = 'inline-flex';
                colorIndicator.className = `color-indicator ${currentOpening.color.toLowerCase()}`;
                colorText.textContent = currentOpening.color.charAt(0).toUpperCase() + currentOpening.color.slice(1);
            } else {
                colorIndicator.style.display = 'none';
            }
            
            // Auto-flip board if playing as Black
            if (currentOpening.color === 'black' && !boardFlipped) {
                flipBoard();
            } else if (currentOpening.color === 'white' && boardFlipped) {
                flipBoard();
            }
            
            updateDisplay();
            updateButtons();
        }
        
        // Flip the board
        function flipBoard() {
            boardFlipped = !boardFlipped;
            const board = document.getElementById('board');
            board.classList.toggle('flipped');
            initBoard();
            if (currentOpening && currentOpening.moves[currentMoveIndex]) {
                renderPosition(currentOpening.moves[currentMoveIndex].position);
            } else {
                renderPosition(startingPosition);
            }
        }
        
        // Next move
        function nextMove() {
            if (currentOpening && currentMoveIndex < currentOpening.moves.length - 1) {
                currentMoveIndex++;
                updateDisplay();
                updateButtons();
            }
        }
        
        // Previous move
        function previousMove() {
            if (currentMoveIndex > 0) {
                currentMoveIndex--;
                updateDisplay();
                updateButtons();
            }
        }
        
        // Reset board
        function resetBoard() {
            currentMoveIndex = 0;
            updateDisplay();
            updateButtons();
        }
        
        // Update the display
        function updateDisplay() {
            if (!currentOpening) {
                renderPosition(startingPosition);
                updateMoveInfo("Starting Position", "Choose an opening above and click 'Next' to begin your chess journey!");
                return;
            }
            
            const move = currentOpening.moves[currentMoveIndex];
            renderPosition(move.position);
            updateMoveInfo(move.move, move.description);
        }
        
        // Update move information
        function updateMoveInfo(move, description) {
            const moveInfo = document.getElementById('moveInfo');
            const totalMoves = currentOpening ? currentOpening.moves.length : 0;
            const currentMove = currentMoveIndex + 1;
            
            let html = `
                <h3>${move}</h3>
                <p>${description}</p>
            `;
            
            if (currentOpening && totalMoves > 0) {
                html += `<div class="move-counter">Move ${currentMove} of ${totalMoves}</div>`;
            }
            
            moveInfo.innerHTML = html;
        }
        
        // Update button states
        function updateButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentMoveIndex === 0;
            nextBtn.disabled = !currentOpening || currentMoveIndex === currentOpening.moves.length - 1;
        }
        
        // Initialize on load
        window.addEventListener('DOMContentLoaded', async () => {
            initBoard();
            await loadGambits();
            renderPosition(startingPosition);
        });
    </script>
</body>
</html>
